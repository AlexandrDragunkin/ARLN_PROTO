//-- Создание двери №2global DoorPath, TextLib;global ProtoPath;DoorPath=GetProtoMac("Doors.ptl");    //-- Путь к папке с прототипамиProtoPath=GetProtoMac("Shkaf.ptl");   //-- Путь к папке с макропрограммами общей библиотеке прототиповTextLib="Lb.room3_iml.#";             //-- Имя библиотеки текстур//------------------------------------------------------------------------------Height=DbVar("Height",1200);	        //-- Высота окнаWidth=DbVar("Width",1200);		        //-- Ширина окнаThick=DbVar("Thickness",300);         //-- Толщина стеныCBWidth=DbVar("CBeamWidth",75);       //-- Ширина перекладиныCBThick=DbVar("CBeamThick",35);       //-- Толщина перекладиныdoorcolor=DbVar("doorcolor",13);      //-- Цвет двериglasscolor=DbVar("glasscolor",9);     //-- Цвет стеклаFlag3D=DbVar("Flag3D",1);             //-- Отображение 3D//------------------------------------------------------------------------------//-- Толщина габаритного параллелепипедаBoxThick=3;//------------------------------------------------------------------------------if (Flag3D==0){  goto D2Draw;}//------------------------------------------------------------------------------// Параллелепипед по габаритам проёмаmacro ProtoPath+"wnd_box_base.mac" Height, Width, -Thick, BoxThick doorcolor;chprop mapbypars last 1 done0,  -1                        //-- Для всех секций1,  TextLib+str(doorcolor)    //-- Меняем код материала на  материал в таблице материалов;//-- Фрагмент рамыmacro ProtoPath+"wnd_frame_base.mac" Height, Width, CBWidth, CBThick, BoxThick      doorcolor glasscolor;//-- Установка фрагмента рамы в параллелепипедmove last 1 done 0 0.5*(Thick+CBThick) 0 nocopy;group all done;exit;//------------------------------------------------------------------------------D2Draw:defarr p1[3], p2[3], p3[3];p1[1]=0;p1[2]=0;p1[3]=0;p2[1]=Width;p2[2]=0;p2[3]=0;p3[1]=Width;p3[2]=CBThick;p3[3]=0;macro ProtoPath+"WDDRHatch.mac" p1 p2 p3 1;move last 1 done 0 0.5*(Thick-CBThick) 0 nocopy;group all done;exit;